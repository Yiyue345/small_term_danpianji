C51 COMPILER V9.56.0.0   MAIN                                                              07/11/2025 16:27:15 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include "reg52.h"
   2          #include "ls138.h"
   3          #include "smg.h"
   4          #include "delay.h"
   5          #include "iic.h"
   6          #include "keyboard.h"
   7          
   8          sbit  RST=P2^4;         
   9          sbit  CLK=P2^3;          
  10          sbit  DP=P2^2;           
  11          
  12          sbit L1 = P0^0;
  13          sbit L8 = P0^7;
  14          
  15          //�ӳٺ���       
  16          
  17          void delay(unsigned int m)       
  18          {
  19   1        
  20   1      unsigned int i,j;
  21   1      for(i=0;i<m;i++)
  22   1        
  23   1      {
  24   2         for(j=0;j<121;j++){}      
  25   2      }
  26   1      }
  27          //��ʱ��T0
  28          void InitTimer0()
  29          {
  30   1        TMOD = 0x01;
  31   1        TH0 = (65535 - 50000) / 256;
  32   1        TL0 = (65535 - 50000) % 256;
  33   1        
  34   1        ET0 = 1;
  35   1        EA = 1;
  36   1        TR0 = 1;
  37   1      }
  38          
  39          // DS1302 ָ��д��
  40          void WriteCommand(unsigned char Command)
  41          {
  42   1      unsigned char i;
  43   1      RST=0;
  44   1      CLK=0;
  45   1      RST=1;
  46   1      for(i=8;i>0;i--)
  47   1           {
  48   2          DP=Command&0x01;
  49   2          CLK=1;
  50   2          Command>>=1;
  51   2         }
  52   1      }
  53          
  54          
  55          //DS1302 ����д��
C51 COMPILER V9.56.0.0   MAIN                                                              07/11/2025 16:27:15 PAGE 2   

  56          void WriteData(unsigned char SendDat)
  57          {
  58   1      unsigned char i;
  59   1      for(i=8;i>0;i--)
  60   1           {
  61   2          DP=SendDat&0x01;
  62   2          CLK=1;
  63   2          SendDat>>=1;
  64   2         }
  65   1      }
  66          
  67          
  68          //DS1302 ��ȡ����
  69          unsigned char ReadData()
  70          {
  71   1        unsigned char i,RecDat=0;
  72   1        for(i=0;i<8;i++)
  73   1           {
  74   2          CLK=1;
  75   2          CLK=0;
  76   2          if(DP)RecDat|=0x01<<i;
  77   2         }
  78   1         return(RecDat);
  79   1      }     
  80          
  81          //DS1302���ֽ�����д��Ͷ�ȡ
  82          void WriteByte(unsigned char Command,unsigned char SendDat)
  83          {
  84   1        WriteCommand(Command);
  85   1        WriteData(SendDat);
  86   1        RST=0;
  87   1      }
  88          unsigned char ReadByte(unsigned char Command)
  89          {
  90   1        unsigned char RecDat=0;
  91   1        WriteCommand(Command);
  92   1        RecDat=ReadData();
  93   1        RST=0;
  94   1        return(RecDat);
  95   1      }
  96          
  97          
  98          //��ʾLED 
  99          
 100          void Init_smgled(){
 101   1      
 102   1      
 103   1      }
 104          
 105          
 106          void updatesmg(){
 107   1       
 108   1      }
 109          
 110          //�жϷ������
 111          unsigned char count = 0;
 112          void serviceTimer0() interrupt 1{
 113   1        TH0 = (65535 - 50000) / 256;
 114   1        TL0 = (65535 - 50000) % 256;
 115   1        
 116   1        count++;
 117   1        if(count % 10 == 0)
C51 COMPILER V9.56.0.0   MAIN                                                              07/11/2025 16:27:15 PAGE 3   

 118   1        {
 119   2          L1 = ~L1;
 120   2        }
 121   1        if(count == 100)
 122   1        {
 123   2          L8 = ~L8;
 124   2          count = 0;
 125   2        }
 126   1      
 127   1      }
 128            
 129          //��main�����������Ŀ�߼�����
 130          void main() {
 131   1        while (1) {
 132   2          unsigned char key = readKey();
 133   2          if (key) {
 134   3            updateLed(1, key % 9);
 135   3          }
 136   2          showLed();
 137   2        }
 138   1        
 139   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    204    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
